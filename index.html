<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>未发送信件焚烧炉 | The Unsent Crematorium</title>
  <meta name="description" content="写下你不敢发送的话，看它化为灰烬，收到一封来自平行时空的回信。">
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=Noto+Sans+SC:wght@300;400;500&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Ambient Background Particles / Ember Sky -->
  <canvas id="ambient-canvas"></canvas>
  
  <!-- Ember Sky Tooltip -->
  <div class="ember-tooltip" id="ember-tooltip"></div>
  
  <main class="container">
    <!-- Header -->
    <header class="header">
      <h1 class="title">未发送信件焚烧炉</h1>
      <p class="subtitle">The Unsent Crematorium</p>
      <p class="tagline">写下你不敢发送的话，让它化为灰烬</p>
    </header>

    <!-- Input Section -->
    <section class="input-section" id="input-section">
      <div class="input-container">
        <textarea 
          id="unsent-message" 
          class="message-input" 
          placeholder="在这里写下那段你一直想说，却不敢发送的话..."
          maxlength="500"
        ></textarea>
        <div class="char-count">
          <span id="char-current">0</span> / 500
        </div>
      </div>
      
      <div class="recipient-section">
        <label class="recipient-label">这段话是写给谁的？（可选）</label>
        <div class="recipient-row">
          <input 
            type="text" 
            id="recipient" 
            class="recipient-input" 
            placeholder="前任、暗恋的人、已故的亲人..."
          >
          <div class="gender-picker" id="gender-picker">
            <button class="gender-btn" data-gender="female" title="女性">
              <span class="gender-icon">♀</span>
            </button>
            <button class="gender-btn" data-gender="male" title="男性">
              <span class="gender-icon">♂</span>
            </button>
          </div>
        </div>
      </div>
      
      <!-- Persona Tags -->
      <div class="persona-section">
        <label class="persona-label">Ta 是个什么样的人？（可选）</label>
        <div class="persona-chips" id="persona-chips">
          <button class="persona-chip" data-persona="gentle">
            <span class="chip-emoji">🌸</span>
            <span class="chip-text">温柔的</span>
          </button>
          <button class="persona-chip" data-persona="strict">
            <span class="chip-emoji">⚡</span>
            <span class="chip-text">严厉的</span>
          </button>
          <button class="persona-chip" data-persona="playful">
            <span class="chip-emoji">😄</span>
            <span class="chip-text">搞怪的</span>
          </button>
          <button class="persona-chip" data-persona="regretful">
            <span class="chip-emoji">🌙</span>
            <span class="chip-text">遗憾的</span>
          </button>
        </div>
      </div>
      
      <!-- Submit Button -->
      <button class="submit-button" id="submit-button">
        <span class="submit-icon">🔥</span>
        <span class="submit-text">准备焚烧</span>
        <span class="submit-particles"></span>
      </button>
    </section>

    <!-- Cremation Section -->
    <section class="cremation-section" id="cremation-section">
      <div class="letter-container" id="letter-container">
        <div class="letter" id="letter">
          <p class="letter-content" id="letter-content"></p>
        </div>
      </div>
      
      <canvas id="fire-canvas"></canvas>
      
      <button class="burn-button" id="burn-button">
        <span class="burn-text">长按焚烧</span>
        <svg class="burn-progress" viewBox="0 0 100 100">
          <circle class="progress-bg" cx="50" cy="50" r="45"/>
          <circle class="progress-ring" cx="50" cy="50" r="45" id="progress-ring"/>
        </svg>
      </button>
      
      <p class="burn-hint">按住按钮 1.5 秒，让这些话化为灰烬</p>
    </section>

    <!-- Reply Section -->
    <section class="reply-section" id="reply-section">
      <div class="envelope" id="envelope">
        <div class="envelope-flap"></div>
        <div class="envelope-body">
          <div class="reply-letter" id="reply-letter">
            <p class="reply-from">来自平行时空的回信</p>
            <div class="reply-content" id="reply-content">
              <!-- AI generated reply will appear here -->
            </div>
            <p class="reply-signature" id="reply-signature"></p>
          </div>
        </div>
      </div>
      
      <!-- Action Buttons -->
      <div class="reply-actions">
        <!-- V1.3: 听见回信 -->
        <button class="listen-button" id="listen-button">
          <span class="listen-icon" id="listen-icon">🎧</span>
          <span class="listen-text" id="listen-text">听见回信</span>
        </button>
        <button class="share-button" id="share-button">
          <span class="share-icon">✨</span>
          <span class="share-text">留作纪念</span>
        </button>
        <button class="restart-button" id="restart-button">
          再写一封
        </button>
      </div>
      
      <!-- V1.3: Audio Player (Hidden) -->
      <audio id="reply-audio" style="display: none;"></audio>
      
      <!-- Share Card Preview Modal -->
      <div class="share-modal" id="share-modal">
        <div class="share-modal-content">
          <button class="modal-close" id="modal-close">×</button>
          <h3 class="modal-title">你的平行时空信笺</h3>
          <div class="share-card-preview" id="share-card-preview">
            <p class="preview-loading">正在生成艺术卡片...</p>
          </div>
          <div class="share-actions">
            <button class="download-button" id="download-button">
              📥 保存图片
            </button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script type="module" src="app.js"></script>
</body>
</html>
